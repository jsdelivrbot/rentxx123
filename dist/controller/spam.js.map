{"version":3,"sources":["../../src/controller/spam.js"],"names":["config","db","api","pusher","appId","key","secret","cluster","encrypted","post","req","res","spam","gender","body","partId","age","epicNumber","isVoted","document","save","err","spam_got","trigger","status","send","find","spams","json"],"mappings":";;;;;;AAAA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;;;kBACc,gBAAoB;AAAA,MAAjBA,MAAiB,QAAjBA,MAAiB;AAAA,MAATC,EAAS,QAATA,EAAS;;AAChC,MAAIC,MAAM,sBAAV;AACF;AACA;AACA,MAAIC,SAAS,qBAAW;AACtBC,WAAO,QADe;AAEtBC,SAAK,sBAFiB;AAGtBC,YAAQ,sBAHc;AAItBC,aAAS,KAJa;AAKtBC,eAAW;AALW,GAAX,CAAb;AAOEN,MAAIO,IAAJ,CAAS,MAAT,EAAiB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAC7B;AACG;AACQ,QAAIC,OAAK,oBAAT;AACAA,SAAKC,MAAL,GAAYH,IAAII,IAAJ,CAASD,MAArB;AACCD,SAAKG,MAAL,GAAYL,IAAII,IAAJ,CAASC,MAArB;AACCH,SAAKI,GAAL,GAASN,IAAII,IAAJ,CAASE,GAAlB;AACCJ,SAAKK,UAAL,GAAgBP,IAAII,IAAJ,CAASG,UAAzB;AACCL,SAAKM,OAAL,GAAaR,IAAII,IAAJ,CAASI,OAAtB;AACCN,SAAKO,QAAL,GAAcT,IAAII,IAAJ,CAASK,QAAvB;AACLP,SAAKQ,IAAL,CAAU,UAACC,GAAD,EAAKC,QAAL,EAAgB;AACzCnB,aAAOoB,OAAP,CAAe,SAAf,EAA0B,SAA1B,EAAqC;AAChBV,gBAAOH,IAAII,IAAJ,CAASD,MADA;AAEhBE,gBAAOL,IAAII,IAAJ,CAASC,MAFA;AAGhBC,aAAIN,IAAII,IAAJ,CAASE,GAHG;AAIhBE,iBAAQR,IAAII,IAAJ,CAASI,OAJD;AAKhBC,kBAAST,IAAII,IAAJ,CAASK;AALF,OAArC;AAOgB,UAAG,CAACE,GAAJ,EAAQ;;AAEJV,YAAIa,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBH,QAArB;AACH,OAHD,MAGK;AACDX,YAAIa,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBJ,GAArB;AACH;AACD,KAdD;AAgBX,GA1BF;;AA8BF;AACInB,MAAIO,IAAJ,CAAS,MAAT,EAAiB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAC7B,mBAAKe,IAAL,CAAU,EAAV,EAAc,UAASL,GAAT,EAAcM,KAAd,EAAqB;AACjChB,UAAIiB,IAAJ,CAAS,EAAC,SAAQD,KAAT,EAAT;AACH,KAFC;AAGL,GAJG;AAKF,SAAOzB,GAAP;AACD,C","file":"spam.js","sourcesContent":["import mongoose from 'mongoose';\r\nimport { Router } from 'express';\r\nimport Spam from '../model/spam';\r\nimport bodyParser from 'body-parser';\r\nimport Pusher from 'pusher';\r\nexport default({ config, db }) => {\r\n  let api = Router();\r\n//adding a city\r\n//v1/city/add\r\nlet pusher = new Pusher({\r\n  appId: '513442',\r\n  key: 'dd20d8a12a2c4b1c7960',\r\n  secret: 'fde09d5acecffcb9f07d',\r\n  cluster: 'ap2',\r\n  encrypted: true\r\n});\r\n  api.post('/add', (req, res) => {\r\n    //check password or match password\r\n       //token matching and only admin can add\r\n               let spam=new Spam();\r\n               spam.gender=req.body.gender;\r\n                spam.partId=req.body.partId;\r\n                 spam.age=req.body.age;\r\n                  spam.epicNumber=req.body.epicNumber;\r\n                   spam.isVoted=req.body.isVoted;\r\n                    spam.document=req.body.document;\r\n               spam.save((err,spam_got)=>{\r\npusher.trigger('os-poll', 'os-vote', {\r\n                     gender:req.body.gender,\r\n                     partId:req.body.partId,\r\n                     age:req.body.age,\r\n                     isVoted:req.body.isVoted,\r\n                     document:req.body.document\r\n});\r\n                if(!err){\r\n\r\n                    res.status(200).send(spam_got);\r\n                }else{\r\n                    res.status(500).send(err);\r\n                }\r\n               });\r\n                    \r\n   });\r\n\r\n\r\n\r\n//get cities here\r\n    api.post('/get', (req, res) => {\r\n      Spam.find({}, function(err, spams) {\r\n        res.json({\"spams\":spams});\r\n    });\r\n});\r\n  return api;\r\n}\r\n"]}