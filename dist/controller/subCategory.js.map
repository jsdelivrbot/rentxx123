{"version":3,"sources":["../../src/controller/subCategory.js"],"names":["config","db","api","post","req","res","findOne","email","body","err","user","undefined","status","json","message","login","token","userType","newCategory","name","category","save","subcat","send","put","findById","params","id","SubCategory","delete","remove","find"],"mappings":"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","file":"subCategory.js","sourcesContent":["import mongoose from 'mongoose';\r\nimport { Router } from 'express';\r\nimport Login from '../model/login';\r\nimport User from '../model/user';\r\nimport Product from '../model/product';\r\nimport SubCategory from '../model/subCategory';\r\nimport bodyParser from 'body-parser';\r\nexport default({ config, db }) => {\r\n  let api = Router();\r\n//adding a category\r\n//v1/category/add\r\n  api.post('/add', (req, res) => {\r\n    //check password or match password\r\n      User.findOne({email:req.body.email},(err,user)=>{\r\n        if(user==undefined){\r\n         res.status(400).json({ message: 'User not found!' });\r\n     }else{\r\n Login.findOne({email:req.body.email},(err,login)=>{\r\n \r\n     if(!err){\r\n \r\n         if(login==undefined){ //user not found\r\n \r\n             res.status(400).json({ message: 'User not Logged In!' });\r\n         }else{\r\n \r\n             if(login.token==req.body.token && user.userType>0){  //token matching and only admin can add\r\n               let newCategory=new SubCategory();\r\n               newCategory.name=req.body.name;\r\n               newCategory.category=req.body.category;\r\n               newCategory.save((err,subcat)=>{\r\n\r\n                if(!err){\r\n\r\n                    res.status(200).send(subcat);\r\n                }else{\r\n                    res.status(500).send(err);\r\n                }\r\n               });\r\n                    \r\n                    \r\n \r\n \r\n             }else{\r\n                 res.status(400).json({ message: 'invalid token!' });\r\n \r\n             }\r\n       \r\n         }\r\n        \r\n     }else{\r\n \r\n             res.status(400).send(err);\r\n         }\r\n   \r\n });\r\n     }\r\n             });\r\n   });\r\n\r\n//v1/category/update\r\n  api.put('/update/:id', (req, res) => {\r\n    //check password or match password\r\n      User.findOne({email:req.body.email},(err,user)=>{\r\n        if(user==undefined){\r\n         res.status(400).json({ message: 'User not found!' });\r\n     }else{\r\n Login.findOne({email:req.body.email},(err,login)=>{\r\n \r\n     if(!err){\r\n \r\n         if(login==undefined){ //user not found\r\n \r\n             res.status(400).json({ message: 'User not Logged In!' });\r\n         }else{\r\n \r\n             if(login.token==req.body.token && user.userType>0){  //token matching and only admin can add\r\n              \r\n\r\n                SubCategory.findById((req.params.id),(err,category)=>{\r\n\r\n                    if(!err){\r\n                        if(category===undefined){\r\n                            res.status(400).send({message:\"no such subcategory exsist!\"});\r\n\r\n                        }else{\r\n                        category.name=req.body.name;\r\n                        category.category=req.body.category;\r\n                        category.save((err,SubCategory)=>{\r\n\r\n                            if(err){\r\n\r\n                                res.status(500).send(err);\r\n                            }else{\r\n\r\n                                res.status(200).send(SubCategory);\r\n                            }\r\n\r\n                        });\r\n                    }\r\n                    }else{\r\n\r\n                        res.status(500).send(err);\r\n                    }\r\n\r\n              });\r\n                    \r\n                    \r\n \r\n \r\n             }else{\r\n                 res.status(400).json({ message: 'invalid token!' });\r\n \r\n             }\r\n       \r\n         }\r\n        \r\n     }else{\r\n \r\n             res.status(400).send(err);\r\n         }\r\n   \r\n });\r\n     }\r\n             });\r\n   });\r\n\r\n   //v1/category/update\r\n  api.delete('/delete/:id/:token/:email', (req, res) => {\r\n    //check password or match password\r\n      User.findOne({email:req.params.email},(err,user)=>{\r\n        if(user==undefined){\r\n         res.status(400).json({ message: 'User not found!' });\r\n     }else{\r\n Login.findOne({email:req.params.email},(err,login)=>{\r\n \r\n     if(!err){\r\n \r\n         if(login==undefined){ //user not found\r\n \r\n             res.status(400).json({ message: 'User not Logged In!' });\r\n         }else{\r\n \r\n             if(login.token==req.params.token && user.userType>0){  //token matching and only admin can add\r\n              \r\n\r\n                SubCategory.findById((req.params.id),(err,category)=>{\r\n\r\n                    if(!err){\r\n                        if(category===undefined){\r\n                            res.status(400).send({message:\"no such subcategory exsist!\"});\r\n\r\n                        }else{\r\n                        category.remove((err)=>{\r\n\r\n                            if(!err){\r\n\r\n                                res.status(200).send({message:\"subcategory deleted!\"});\r\n                            }else{\r\n\r\n                                res.status(500).send(err);\r\n                            }\r\n                        });\r\n                    }\r\n                    }else{\r\n\r\n                        res.status(500).send(err);\r\n                    }\r\n\r\n              });\r\n                    \r\n                    \r\n \r\n \r\n             }else{\r\n                 res.status(400).json({ message: 'invalid token!' });\r\n \r\n             }\r\n       \r\n         }\r\n        \r\n     }else{\r\n \r\n             res.status(400).send(err);\r\n         }\r\n   \r\n });\r\n     }\r\n             });\r\n   });\r\n\r\n    //get subCategory here\r\n    api.post('/get', (req, res) => {\r\n      SubCategory.find({category:req.body.category}, function(err,subcat) {\r\n        res.json({\"subCategories\":subcat});\r\n    });\r\n});\r\n  return api;\r\n}\r\n"]}